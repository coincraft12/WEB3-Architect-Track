# 12강. 기본 시나리오 구조 해석: “주체·행동·자산”을 연결해 WEB3를 읽는 1차 프레임

## 0) 이 강의의 한 문장
**WEB3의 모든 사건은 “누가(주체) → 무엇을(행동) → 어떤 자산을 → 어떤 규칙(컨트랙트) 아래에서”로 해석할 수 있다.**  
이 강의는 앞선 1~11강의 개념을 하나의 렌즈로 묶어, 어떤 서비스든 ‘구조’로 읽는 최소 프레임을 만든다.

---

## 1) 강의 목표 (수강생이 끝나고 할 수 있어야 하는 것)
이 강의를 마치면 수강생은:

1. 임의의 WEB3 상황(송금/스왑/예치/민팅 등)을 **주체·행동·자산·규칙** 프레임으로 분해할 수 있다.  
2. 트랜잭션을 “기록”이 아니라 “행동(서명된 의사)”으로 해석할 수 있다(6강 복습).  
3. 성공/실패/가스/승인을 포함한 “실행 조건”까지 기본적으로 읽을 수 있다(9~10강 연결).  
4. 단순 사용자가 아니라 “구조 설계자” 관점에서 **어디가 위험 경계인지** 1차로 식별할 수 있다.  
5. 13강(위험요소 분류), 14강(체크리스트)로 자연스럽게 연결된다.

---

## 2) 도입 멘트 (강의 시작 2~3분 대본)
> 지금까지 우리는 개념을 따로따로 배웠습니다.  
> 지갑, 주소, 트랜잭션, 성공/실패, 가스, 컨트랙트.  
>  
> 그런데 실전에서는 이런 질문을 받죠.  
> “이 서비스는 안전해요?” “이건 뭐 하는 건가요?”  
>  
> 그때 필요한 건 지식이 아니라 **해석 프레임**입니다.  
> 오늘은 어떤 WEB3 상황이 와도 최소한으로 해부할 수 있는  
> “주체·행동·자산·규칙” 프레임을 완성합니다.

---

## 3) 12강의 핵심 도구: S-A-A-R 프레임(Subject-Action-Asset-Rule)
이 강의에서 사용할 표준 프레임(기록용 템플릿):

1) **Subject(주체)**: 누가 행동을 시작했나? (EOA/컨트랙트/봇/멀티시그)  
2) **Action(행동)**: 무엇을 요청했나? (send/swap/approve/deposit/mint…)  
3) **Asset(자산)**: 어떤 자산이 움직이거나 잠겼나? (Native/Token/NFT/LP)  
4) **Rule(규칙/컨트랙트)**: 어떤 규칙 아래에서 실행되나? (DEX, Vault, Token contract…)

> **S-A-A-R 한 문장**
> “누가, 어떤 행동을, 어떤 자산으로, 어떤 규칙 아래에서 했는가”

---

## 4) 프레임 확장: 조건과 결과까지 붙이면 ‘구조 해석 카드’가 된다
S-A-A-R만으로도 해석이 되지만, 실전에서는 아래 2개를 붙이면 완성도가 급상승한다.

5) **Constraints(조건)**: 실행 조건은? (승인/가스/슬리피지/nonce/deadline)  
6) **Result(결과)**: 상태 변화는? (성공/실패, 실제 잔액/포지션 변화)

즉, 실전용 카드:
- S(주체) / A(행동) / A(자산) / R(규칙) / C(조건) / R(결과)

(혼동 방지: Rule과 Result가 둘 다 R이라, 기록할 땐 Rule=Rule, Result=Result로 표기)

---

## 5) 기본 시나리오 6종(초급에서 가장 많이 마주치는 “행동 유형”)
아래 6개는 “어떤 서비스든 결국 여기로 귀결된다”는 느낌으로 잡는다.

1) **송금(Transfer Native)**: EOA→EOA, value 중심  
2) **토큰 전송(Transfer Token)**: EOA→Token Contract 호출  
3) **승인(Approve/Permit)**: “권한 위임” 행동(가장 위험)  
4) **스왑(Swap)**: DEX 규칙 아래 자산 교환  
5) **예치/인출(Deposit/Withdraw)**: Vault/Lending 등 보관/담보화  
6) **민팅/소각(Mint/Burn)**: 발행 규칙에 따른 공급 변화(NFT 포함)

**설계자 포인트**
- “복잡한 서비스”도 결국은 위 행동들의 조합이다.

---

## 6) 시나리오 예시 1: 단순 송금(EOA→EOA)
### 상황
- 사용자가 친구에게 ETH 0.1을 보낸다.

### S-A-A-R 해석
- Subject: 사용자 EOA  
- Action: transfer native  
- Asset: ETH(네이티브)  
- Rule: 프로토콜 규칙(EOA 송금 규칙)

### 조건/결과
- Constraints: 가스 충분? nonce 정상? 네트워크 맞음?  
- Result: sender 잔액 감소 + receiver 잔액 증가(상태 변화)

---

## 7) 시나리오 예시 2: 토큰 전송(EOA→Token Contract)
### 상황
- USDC를 다른 주소로 전송한다.

### S-A-A-R 해석
- Subject: 사용자 EOA  
- Action: token transfer(컨트랙트 호출)  
- Asset: USDC(ERC-20)  
- Rule: USDC 토큰 컨트랙트의 규칙(상태 맵핑 변경)

### 조건/결과
- Constraints: 가스/nonce, 토큰 잔액, 체인 일치  
- Result: 토큰 컨트랙트의 storage가 바뀐다(잔액 매핑)

**포인트**
- “토큰 전송은 호출”이라는 11강 복습 연결이 여기서 실전이 된다.

---

## 8) 시나리오 예시 3: 승인(Approve) 후 스왑(Swap)
### 상황
- 사용자가 DEX에서 토큰을 스왑하려고 한다.

### 8.1 Step 1: Approve(권한 위임)
- Subject: 사용자 EOA  
- Action: approve(spender에게 allowance 부여)  
- Asset: 토큰(권한 대상)  
- Rule: 토큰 컨트랙트의 approve 규칙

**조건/결과**
- Constraints: 사용자 의도 이해(무기한? 한도?), 가스  
- Result: allowance 상태가 바뀜(권한이 생김)

### 8.2 Step 2: Swap(교환 실행)
- Subject: 사용자 EOA  
- Action: swap(DEX 컨트랙트 호출)  
- Asset: token A → token B  
- Rule: DEX/Router 규칙(풀, 수수료, 슬리피지)

**조건/결과**
- Constraints: 슬리피지/데드라인/유동성/가스  
- Result: 토큰 잔액 변화 + 풀 상태 변화 + 이벤트 로그

**설계자 포인트**
- 많은 사고는 swap이 아니라 approve에서 터진다(권한 경계).

---

## 9) 시나리오 예시 4: 예치(Deposit)와 ‘증표 토큰’(LP/Receipt Token)
### 상황
- 사용자가 Vault에 자산을 예치하고, 그 대가로 “증표 토큰”을 받는다.

### S-A-A-R 해석
- Subject: 사용자 EOA  
- Action: deposit  
- Asset: 예치 토큰 + 증표 토큰(새로 받는 자산)  
- Rule: Vault 규칙(지분/정산/인출 조건)

### 조건/결과
- Constraints: approve 필요 여부, 가스, 최소 예치량  
- Result: Vault 상태 변화 + 사용자에게 지분/증표 토큰 발행

**포인트**
- “내 자산이 어디로 갔지?”를  
  “자산이 이동한 게 아니라 ‘형태가 바뀌었다’”로 읽어야 한다.

---

## 10) 시나리오 예시 5: 민팅(Mint) — NFT/포인트/토큰
### 상황
- 사용자가 NFT를 민팅한다.

### S-A-A-R 해석
- Subject: 사용자 EOA  
- Action: mint  
- Asset: NFT(새 자산) + 지불한 ETH(있을 수도)  
- Rule: NFT 컨트랙트의 민팅 규칙(가격/한도/화이트리스트)

### 조건/결과
- Constraints: 민팅 조건(시간, 수량, 서명, 가스), 실패(revert) 가능  
- Result: 소유권 매핑 변경 + 토큰 ID 발행 + 이벤트 기록

---

## 11) “구조 해석 카드” 템플릿(이 강의 핵심 산출물)
아래 템플릿을 그대로 복사해서 어떤 케이스든 적용한다.

### 구조 해석 카드(Template)
- Subject(주체):  
- Action(행동):  
- Asset(자산): (움직이는 것 / 새로 받는 것 / 잠기는 것)  
- Rule(규칙/컨트랙트): (어떤 컨트랙트/어떤 규칙?)  
- Constraints(조건): (승인/가스/슬리피지/nonce/기한/권한)  
- Result(결과): (성공/실패, 상태 변화 3줄 요약)  
- Risk Notes(리스크 메모): (권한 경계/실수 포인트 3개)

---

## 12) 미니 실습(25~30분) — “내가 실제로 했던 행동”을 카드로 해석하기
### 실습 주제
최근에 한 행동 1개(송금/스왑/예치/민팅 등)를 골라, 구조 해석 카드 작성

실습 체크포인트:
1) 행동이 1단계인가, 2단계(approve+call)인가?  
2) To는 EOA인가 Contract인가?  
3) 자산은 이동했나, 형태가 바뀌었나(증표/LP)?  
4) 조건(슬리피지/데드라인/가스)이 실패 가능성을 만들었나?  
5) 결과는 상태로 확인 가능한가?

**출력(산출물)**: 구조 해석 카드 1장(완성)

---

## 13) 과제
### 과제 1: 6종 행동 각각 1개씩 카드 작성(총 6장)
- 송금 / 토큰전송 / 승인 / 스왑 / 예치 / 민팅  
(본인이 직접 안 해봤으면 “가상 시나리오”로 만들어도 됨)

### 과제 2(선택): “서비스 1개”를 행동 조합으로 분해하기(1페이지)
- 예: 어떤 DEX/예치 서비스든 하나 선택  
- 사용자 여정(온보딩→행동)을  
  “approve → deposit → swap → withdraw” 같은 행동 조합으로 표현

---

## 14) 강의 마무리 30초 대본
> 오늘은 WEB3를 읽는 최소 프레임을 만들었습니다.  
> “주체·행동·자산·규칙”, 그리고 조건과 결과까지 붙이면  
> 어떤 서비스든 구조로 해부할 수 있습니다.  
>  
> 다음 강의에서는 이 프레임 위에 **위험요소 분류(승인·서명·권한 경계)** 를 얹어서,  
> 실전에서 “어디가 터질 수 있는지”를 빠르게 식별하는 훈련을 하겠습니다.

---

## 15) 퀴즈(12문항, 복습용)
1) S-A-A-R 프레임을 쓰고 각각을 설명하라.  
2) 트랜잭션을 “행동”이라고 부르는 이유는?  
3) 토큰 전송이 컨트랙트 호출인 이유는?  
4) approve가 왜 위험 경계가 되는가?  
5) 스왑에서 중요한 조건 2가지는?  
6) 예치에서 “증표 토큰”이 의미하는 바는?  
7) 민팅의 조건이 실패(revert)를 만드는 이유는?  
8) 구조 해석 카드에 반드시 들어가야 할 항목 6개는?  
9) “자산이 이동한 게 아니라 형태가 바뀌었다”를 예치 사례로 설명하라.  
10) Rule(규칙/컨트랙트) 항목이 중요한 이유는?  
11) Constraints(조건)를 빼고 해석하면 생기는 문제 1가지는?  
12) 이 프레임이 13강/14강으로 어떻게 연결되는가?

---

## 16) (집필 확장용) 이 강의를 책으로 옮기면 이렇게 된다
- 1. 지식에서 프레임으로: 구조 설계자의 렌즈  
- 2. S-A-A-R: 주체·행동·자산·규칙  
- 3. 조건과 결과: 실행 가능한 해석 카드  
- 4. 6가지 기본 행동 패턴(전송/호출/승인/스왑/예치/민팅)  
- 5. 실습: 구조 해석 카드 작성  
- 6. 다음 장 예고: 위험요소 분류(승인·서명·권한 경계)
