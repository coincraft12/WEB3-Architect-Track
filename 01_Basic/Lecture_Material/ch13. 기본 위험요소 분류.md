# 13강. 기본 위험요소 분류: 승인·서명·권한 경계(Trust Boundary)를 찾아라

## 1) 이 강의의 한 문장
**WEB3의 사고는 “가격”이 아니라 “권한(Authority)”에서 터진다.**  
구조 설계자는 항상 “어디에서 권한이 넘어가고, 누가 무엇을 할 수 있게 되는가(경계)”부터 찾는다.

## 2) 강의 목표 (수강생이 끝나고 할 수 있어야 하는 것)
이 강의를 마치면 수강생은:

1. WEB3 위험을 “사기/해킹” 같은 감정적 단어가 아니라 **권한 경계**로 분류할 수 있다.  
2. 기본 위험요소 9종을 이해하고, 임의의 시나리오(12강 카드)에 붙여 위험요소를 식별할 수 있다.  
3. 승인(approve/permit)과 서명(signature)의 차이를 구조적으로 설명하고, 각각의 대표 리스크를 말할 수 있다.  
4. “내가 지금 무엇을 넘겼는가?”를 한 문장으로 요약하는 습관을 만들 수 있다.  
5. 14강 체크리스트 작성으로 연결할 수 있다(위험요소 → 점검 항목).

## 3) 핵심 개념: Trust Boundary(신뢰 경계)란?
**신뢰 경계**는 “여기부터는 내 통제권이 아니다”가 시작되는 지점이다.

- 내 키(EOA) 안: 내가 통제  
- 컨트랙트(규칙): 규칙이 통제  
- 외부 운영자/업그레이드 권한: 타인이 통제  
- 오프체인 서버/서명자: 또 다른 통제

**설계자 관점**
- 위험은 “나쁜 사람”이 아니라 “경계 넘어가기”에서 생긴다.

## 4) 위험요소 분류의 큰 지도: 3대 경계
이번 강의는 위험요소를 3대 경계로 묶어서 배운다.

1) **서명(Signature) 경계**: “내 의사결정(행동 승인)”  
2) **승인(Approval) 경계**: “권한 위임(대리 실행 권한)”  
3) **권한/통제(Authority) 경계**: “규칙/운영/업그레이드 권한이 누구에게 있나”

이 3개가 Basic 단계에서의 ‘위험의 뼈대’다.

## 5) 핵심 구분: 서명(Sign) vs 승인(Approve)
### 서명(Signature)
- 의미: “이 트랜잭션/메시지를 내가 승인했다”
- 범위: 보통 “1회성 행동”에 가깝다(해당 요청 1건)

대표 리스크:
- **서명 내용 오해**(무엇에 동의했는지 모름)
- **피싱 UI**로 다른 행동을 승인
- **체인/컨텍스트 착각**(다른 세계에서의 승인)

### 승인(Approval / Allowance / Permit)
- 의미: “앞으로 이 주소(Spender)가 내 토큰을 대신 써도 된다”
- 범위: **지속성/반복성**이 핵심(이게 무섭다)

대표 리스크:
- **무기한/과도한 allowance**
- **스펜더가 악성/취약하면 반복적으로 털린다**
- 예전 승인(내가 잊은 권한)이 나중에 악용된다

**암기 문장**
- 서명은 “이번 한 번 동의”
- 승인은 “앞으로도 대신해도 됨(문을 열어둠)”

## 6) 기본 위험요소 9종(초급 필수)
아래 9개는 Basic 과정의 “표준 분류”로 써도 된다.

### R1. 잘못된 대상(To) 위험 (주소/컨트랙트 오인)
- EOA로 보냈어야 하는데 컨트랙트로 보냄
- 유사 주소/클립보드 변조/라벨링 부재

**신뢰 경계**: 대상 식별 실패

### R2. 네트워크/체인 착각 위험(세계 선택 오류)
- 주소는 같아 보이는데 체인이 다름
- 브릿지/레이어2/테스트넷 혼동

**신뢰 경계**: 세계 선택(ChainId)

### R3. 승인 과부여 위험(무기한/과도한 allowance)
- 스왑하려다 무기한 승인
- 이후 스펜더가 내 자산을 반복적으로 이동 가능

**신뢰 경계**: 권한 위임(Approval)

### R4. 서명 오해 위험(무엇에 동의했는지 모름)
- “로그인/연결”처럼 보였는데 실제로는 권한 부여
- 메시지 서명(Sign-in)과 트랜잭션 서명을 혼동

**신뢰 경계**: 의사결정(Signature)

### R5. 권한 구조 불투명 위험(Owner/Role/관리자 권한)
- onlyOwner, role-based access control
- 관리자/운영자가 특정 행동을 할 수 있음(동결/수정/회수 등)

**신뢰 경계**: 운영 권한(Authority)

### R6. 업그레이드/프록시 위험(규칙이 바뀔 수 있음)
- 지금은 정상인데, 나중에 코드가 바뀌면 위험
- Basic에서는 “업그레이드 가능성 자체가 위험 경계”라는 감만 잡는다

**신뢰 경계**: 규칙 변경권(Authority over Rule)

### R7. 조건 파라미터 위험(슬리피지/데드라인/최소수량)
- 스왑 조건을 느슨하게 잡으면 손해가 구조적으로 허용됨
- 반대로 너무 빡세면 revert 반복

**신뢰 경계**: 실행 조건(Constraints)

### R8. 가스/실행 실패 유도 위험(실행 조건 착시)
- pending 유도(낮은 우선순위)로 사용자를 조급하게 만듦
- 실패를 반복시키며 사용자 행동을 유도(심리적 공격 포함)

**신뢰 경계**: 실행 가능성/성공 확률(Execution viability)

### R9. 외부 의존 위험(오라클/서버/프론트엔드/서명자)
- 컨트랙트는 안전해도 프론트엔드가 거짓 정보 제공 가능
- 오프체인 서명자가 결정권을 가짐(화이트리스트, 가격 서명 등)

**신뢰 경계**: 오프체인 통제(External trust)

## 7) 위험요소를 12강 구조 해석 카드에 붙이는 방법(실전 프로세스)
12강 카드(S-A-A-R + Constraints + Result)를 만들었다면,  
이제 “Risk Notes” 칸에 아래 순서로 채운다.

1) **경계 3개부터 체크**  
   - 서명(내가 뭘 승인?)  
   - 승인(문을 열어뒀나?)  
   - 권한(운영자가 뭘 할 수 있나?)

2) 위험요소 9종 중 해당되는 것에 체크  
3) 각 위험요소마다 “피해 형태”를 1문장으로 기록  
   - 예: “무기한 승인 → 이후 반복 인출 가능”

## 용어 보충(Quick Reference)
- Trust Boundary: 통제권이 사용자 밖으로 넘어가는 경계 지점.
- Allowance: 토큰을 타 주소가 대신 사용할 수 있도록 준 한도 권한.
- Permit: 온체인 승인 트랜잭션 없이 서명으로 승인 의사를 전달하는 방식.
- Owner/Role: 컨트랙트 운영·변경 권한을 가진 관리자 권한 집합.
- External Dependency: 프론트/오라클/서명자 등 오프체인 의존 요소.

## 헷갈리는 개념 보충
- 서명(sign)과 승인(approve)은 다르다.
- 서명은 특정 행동 승인, 승인은 자산 사용 권한 위임(지속 가능)이다.

